"use strict";(self.webpackChunk_teamhanko_docs=self.webpackChunk_teamhanko_docs||[]).push([[427],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),l=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=l(e.components);return a.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,u=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=l(n),m=r,h=p["".concat(u,".").concat(m)]||p[m]||d[m]||o;return n?a.createElement(h,s(s({ref:t},c),{},{components:n})):a.createElement(h,s({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=p;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var l=2;l<o;l++)s[l]=n[l];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(7294),r=n(6010);const o="tabItem_Ymn6";function s(e){let{children:t,hidden:n,className:s}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,s),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>I});var a=n(7462),r=n(7294),o=n(6010),s=n(2466),i=n(6775),u=n(1980),l=n(7392),c=n(12);function d(e){return function(e){return r.Children.map(e,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function p(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??d(n);return function(e){const t=(0,l.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:n}=e;const a=(0,i.k6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,u._X)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=p(e),[s,i]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[u,l]=h({queryString:n,groupId:a}),[d,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,c.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:a}),k=(()=>{const e=u??d;return m({value:e,tabValues:o})?e:null})();(0,r.useLayoutEffect)((()=>{k&&i(k)}),[k]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),l(e),f(e)}),[l,f,o]),tabValues:o}}var k=n(2389);const g="tabList__CuJ",b="tabItem_LNqP";function y(e){let{className:t,block:n,selectedValue:i,selectValue:u,tabValues:l}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,s.o5)(),p=e=>{const t=e.currentTarget,n=c.indexOf(t),a=l[n].value;a!==i&&(d(t),u(a))},m=e=>{var t;let n=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;n=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;n=c[t]??c[c.length-1];break}}null==(t=n)||t.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t)},l.map((e=>{let{value:t,label:n,attributes:s}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>c.push(e),onKeyDown:m,onClick:p},s,{className:(0,o.Z)("tabs__item",b,null==s?void 0:s.className,{"tabs__item--active":i===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;if(n=Array.isArray(n)?n:[n],t){const e=n.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},n.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function w(e){const t=f(e);return r.createElement("div",{className:(0,o.Z)("tabs-container",g)},r.createElement(y,(0,a.Z)({},e,t)),r.createElement(v,(0,a.Z)({},e,t)))}function I(e){const t=(0,k.Z)();return r.createElement(w,(0,a.Z)({key:String(t)},e))}},9466:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>u,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var a=n(7462),r=(n(7294),n(3905)),o=n(4866),s=n(5162);const i={title:"Getting user data",sidebar_label:"User data",keywords:["user","user ID","userID","email"]},u=void 0,l={unversionedId:"guides/tutorials/userData",id:"guides/tutorials/userData",title:"Getting user data",description:"Every project has different needs when handling user onboarding. The following sections show how to get the user data from Hanko.",source:"@site/docs/guides/tutorials/userData.mdx",sourceDirName:"guides/tutorials",slug:"/guides/tutorials/userData",permalink:"/guides/tutorials/userData",draft:!1,tags:[],version:"current",frontMatter:{title:"Getting user data",sidebar_label:"User data",keywords:["user","user ID","userID","email"]},sidebar:"docs",previous:{title:"Next.js",permalink:"/guides/tutorials/nextjs"}},c={},d=[{value:"Get user data on the Frontend",id:"get-user-data-on-the-frontend",level:2},{value:"Get user data on the Backend",id:"get-user-data-on-the-backend",level:2},{value:"Get user ID from the JWT",id:"get-user-id-from-the-jwt",level:3},{value:"Get user data using the Hanko Admin API",id:"get-user-data-using-the-hanko-admin-api",level:3}],p={toc:d};function m(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Every project has different needs when handling user onboarding. The following sections show how to get the user data from Hanko."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"It's good to remember that the user ID is the immmutable identifier")),(0,r.kt)("p",{parentName:"admonition"},"The primary email address can be changed, therefore when handling user registration, the user ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," should be used to\ndermine if it's a known user.")),(0,r.kt)("h2",{id:"get-user-data-on-the-frontend"},"Get user data on the Frontend"),(0,r.kt)("p",null,"If you only need the user data for a frontend usage, you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"Hanko.user.getCurrent()")," function from the\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@teamhanko/hanko-frontend-sdk"},"hanko-frontend-sdk")," (it is also re-exported from\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@teamhanko/hanko-elements"},"hanko-elements"),"):"),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(s.Z,{value:"next.js",label:"Next.js",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'"use client";\n\nimport { Hanko } from "@teamhanko/hanko-elements";\n\nconst hankoApi = <YOUR_HANKO_API_URL>;\nconst hanko = new Hanko(hankoApi);\n\nconst {id, email} = await hanko.user.getCurrent();\n\nconsole.log(`user-id: ${id}, email: ${email}`);\n')))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Please keep in mind that if you create a function to get the\nuser data, you will be fetching data from the API again every\ntime you call the function. We advise you to make sure the function\nis only called once for every user authentication.")),(0,r.kt)("h2",{id:"get-user-data-on-the-backend"},"Get user data on the Backend"),(0,r.kt)("h3",{id:"get-user-id-from-the-jwt"},"Get user ID from the JWT"),(0,r.kt)("p",null,"The Hanko API sends back a cookie upon successful authentication, which is then sent to the RP backend for each subsequent\nrequest. The cookie contains a JWT, one of the things we can get from this JWT is the user ID, we can use ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/jose"},"jose library"),"\nto decode the value of such JWT:"),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(s.Z,{value:"next.js",label:"Next.js",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'import { cookies } from "next/headers";\nimport * as jose from "jose";\n\nexport async function userId() {\n  const token = cookies().get("hanko")?.value;\n  const payload = jose.decodeJwt(token ?? "");\n\n  const userID = payload.sub;\n  return userID;\n}\n')))),(0,r.kt)("h3",{id:"get-user-data-using-the-hanko-admin-api"},"Get user data using the Hanko Admin API"),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"https://docs.hanko.io/api/admin"},"Hanko Admin API")," provides detailed information about the status, user management, metrics and more. In this example we will focus on\ngetting the data from a specific user."),(0,r.kt)("p",null,"To get a specific user data, call the ",(0,r.kt)("inlineCode",{parentName:"p"},"/users/{id}")," endpoint of the Hanko Admin API, where ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," is the user id previously obtained from the JWT."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"On Hanko Cloud the Hanko Admin API is a paid feature and must be enabled separately."),(0,r.kt)("p",{parentName:"admonition"},"You also need an API key ",(0,r.kt)("inlineCode",{parentName:"p"},"secret")," to access the Hanko Admin API. You can generate one under the ",(0,r.kt)("inlineCode",{parentName:"p"},"Settings/API Keys")," section of your project.\nKeep in mind, that the API key ",(0,r.kt)("inlineCode",{parentName:"p"},"secret")," is only showed once, so make sure to store it in a safe place, like an enviromental variable as shown in the following example.")),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(s.Z,{value:"next.js",label:"Next.js",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'const getUserData = async () => {\n  const adminAPI = process.env.ADMIN_API;\n  const adminSecret = process.env.ADMIN_SECRET;\n  const options = {\n    method: "GET",\n    headers: {\n      Authorization: `Bearer ${adminSecret}`,\n    },\n  };\n\n  const response = await fetch(`${adminAPI}/users/${userID}`, options);\n\n  return response.json();\n};\n\nconst userData = await getUserData();\nconsole.log("user data:", userData);\n')))))}m.isMDXComponent=!0}}]);